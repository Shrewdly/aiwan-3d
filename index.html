<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çˆ±æ™šäº­å‡ ä½•æ¢ç´¢</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #b83b5e;
            --accent-color: #f08a5d;
            --text-dark: #333;
            --panel-bg: rgba(255, 255, 255, 0.9);
            --bg-color: #f8f9fa;
        }
        
        html, body { 
            margin: 0; padding: 0; 
            width: 100%; height: 100%; 
            font-family: 'ZCOOL XiaoWei', 'Microsoft YaHei', serif; 
            overflow: hidden; 
            background: url('bg_texture.jpg') center/cover no-repeat, 
                        linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
        }

        .app-wrapper { display: flex; flex-direction: column; height: 100%; }
        .navbar { background: transparent; padding: 10px 0; flex-shrink: 0; z-index: 100; box-shadow: none; pointer-events: none; }
        .container { max-width: 1500px; width: 90%; margin: 0 auto; padding: 0 20px; box-sizing: border-box; }

        .nav-content { 
            pointer-events: auto;
            display: flex; justify-content: space-between; align-items: center; 
            background: rgba(184, 59, 94, 0.9); padding: 8px 30px; border-radius: 50px; 
            box-shadow: 0 4px 15px rgba(184, 59, 94, 0.3); border: 2px solid #fff; 
        }
        .logo { font-family: 'Ma Shan Zheng', cursive; font-size: 26px; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .nav-tabs { display: flex; gap: 10px; background: rgba(0,0,0,0.1); padding: 4px; border-radius: 20px; }
        .nav-tab { padding: 6px 16px; border-radius: 16px; cursor: pointer; font-size: 16px; transition: 0.2s; color: rgba(255,255,255,0.8); }
        .nav-tab.active { background: white; color: var(--primary-color); font-weight: bold; }

        .main-content { flex: 1; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; padding-bottom: 100px; }
        .module-section { display: none; height: 100%; padding: 20px 0; box-sizing: border-box; }
        .module-section.active { display: block; }
        .feature-grid { display: grid; grid-template-columns: 320px 1fr; gap: 30px; height: 100%; align-items: stretch; }

        .control-panel { 
            background: var(--panel-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 2px solid var(--primary-color);
            padding: 30px; 
            height: fit-content; 
            border-radius: 16px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            pointer-events: auto;
        }
        .control-panel h3 { border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-top: 0; color: var(--primary-color); font-family: 'Ma Shan Zheng', cursive; text-align: center; font-size: 24px; }

        .model-stage { width: 100%; height: 100%; background: #87CEEB; border-radius: 4px; overflow: hidden; position: relative; border: 8px solid #fff; outline: 2px solid #ddd; box-shadow: inset 0 0 20px rgba(0,0,0,0.2), 0 10px 30px rgba(0,0,0,0.15); pointer-events: auto; }
        
        body.fullscreen-mode .navbar, body.fullscreen-mode .control-panel, body.fullscreen-mode .bottom-nav, body.fullscreen-mode .section-header { display: none !important; }
        body.fullscreen-mode .container, body.fullscreen-mode .app-wrapper, body.fullscreen-mode .main-content { padding: 0; margin: 0; max-width: none; height: 100%; }
        body.fullscreen-mode .module-section { padding: 0; }
        body.fullscreen-mode .feature-grid { display: block; width: 100%; height: 100%; }
        body.fullscreen-mode .model-stage { position: fixed !important; top: 0; left: 0; width: 100vw !important; height: 100vh !important; z-index: 999; border: none; outline: none; margin: 0; }
        
        body.fullscreen-mode #digital-human-container { z-index: 10000 !important; bottom: 40px; right: 40px; }

        .fullscreen-btn { position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.6); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 50; transition: 0.2s; font-size: 18px; }
        .fullscreen-btn:hover { background: rgba(0,0,0,0.8); transform: scale(1.1); }

        .game-card {
            background: #fffbf0; width: 500px; padding: 30px;
            border-radius: 15px; border: 4px solid var(--primary-color);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center; position: relative;
        }
        .close-game { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; color: var(--primary-color); }
        .game-options { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .game-option { background: white; border: 2px solid #ddd; padding: 15px; border-radius: 10px; cursor: pointer; transition: 0.2s; font-size: 18px; color: var(--text-dark); }
        .game-option:hover { background: #ffe6e6; border-color: var(--primary-color); }
        .game-result { margin-top: 20px; font-size: 20px; font-weight: bold; min-height: 30px; }

        .action-btn { width: 100%; padding: 12px 20px; border: 1px solid transparent; border-radius: 8px; margin-bottom: 12px; cursor: pointer; background: linear-gradient(145deg, #ffffff, #e6e6e6); box-shadow: 5px 5px 10px #d1d1d1, -5px -5px 10px #ffffff; font-family: 'ZCOOL XiaoWei', serif; font-size: 18px; color: #555; text-align: left; padding-left: 20px; transition: all 0.3s ease; position: relative; overflow: hidden; }
        .action-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,0,0,0.1); }
        .action-btn.active { background: var(--primary-color) !important; color: white !important; border: 2px solid #ffd700; box-shadow: 0 0 15px rgba(184, 59, 94, 0.6); }
        .action-btn::after { content: 'â€'; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); opacity: 0.2; font-size: 16px; }
        .action-btn i { margin-right: 10px; width: 24px; text-align: center; }
        input[type=range] { width: 100%; accent-color: var(--primary-color); margin: 10px 0; }

        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: rgba(255,255,255,0.9); border-top: 1px solid #eee; backdrop-filter: blur(5px); display: flex; justify-content: space-around; padding: 8px 0; z-index: 200; height: 60px; box-sizing: border-box; }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #999; font-size: 14px; cursor: pointer; transition: 0.2s; font-family: 'ZCOOL XiaoWei', serif; }
        .nav-item i { font-size: 20px; margin-bottom: 4px; }
        .nav-item.active { color: var(--primary-color); font-weight: bold; transform: scale(1.1); }
        .nav-item.music-active { color: var(--primary-color); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* ğŸ”¥ğŸ”¥ æ ¸å¿ƒä¿®å¤ï¼šå¤§å¹…æé«˜ Z-Index å¹¶å…è®¸é¼ æ ‡äº‹ä»¶ ğŸ”¥ğŸ”¥ */
        #digital-human-container { 
            position: fixed; bottom: 70px; right: 20px; 
            z-index: 5000; /* æåˆ°æœ€é«˜å±‚çº§ä¹‹ä¸€ */
            display: flex; flex-direction: column; align-items: flex-end; 
            transition: all 0.3s;
            pointer-events: auto; /* ç¡®ä¿å¯ç‚¹å‡» */
        }
        .video-wrapper { 
            width: 100px; height: 100px; border-radius: 50%; overflow: hidden; background: white; 
            cursor: pointer; /* é¼ æ ‡æ‰‹åŠ¿ */
            transition: 0.3s; border: 4px solid #fff; box-shadow: 0 0 0 2px var(--primary-color), 0 8px 20px rgba(0,0,0,0.3); 
        }
        .video-wrapper:hover { transform: scale(1.05); }
        #digital-human-video { width: 100%; height: 100%; object-fit: cover; }
        
        .chat-window { width: 300px; height: 350px; background-color: #fffbf0; border: 2px solid var(--primary-color); border-radius: 12px; margin-bottom: 15px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 5px 25px rgba(0,0,0,0.2); transition: 0.3s; transform-origin: bottom right; }
        .chat-window.hidden { transform: scale(0); opacity: 0; height: 0; margin: 0; }
        .chat-history { flex: 1; padding: 15px; overflow-y: auto; background: transparent; font-size: 14px; }
        .message { margin-bottom: 10px; padding: 10px 14px; border-radius: 10px; max-width: 85%; line-height: 1.5; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .message.teacher { background-color: #fff; border-left: 4px solid var(--primary-color); align-self: flex-start; }
        .message.user { background-color: var(--primary-color); color: #fff; align-self: flex-end; border-radius: 12px 12px 0 12px; }
        .chat-input { display: flex; border-top: 1px solid #e0dac0; padding: 10px; background: #fffbf0; }
        .chat-input input { flex: 1; border: 1px solid #d4c4a8; border-radius: 20px; padding: 8px 15px; outline: none; background: #fff; font-family: 'ZCOOL XiaoWei', serif; }
        .chat-input button { margin-left: 8px; background: var(--primary-color); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; }

        #intro-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .intro-card { background: #fffbf0; padding: 40px; border-radius: 20px; text-align: center; width: 400px; box-shadow: 0 10px 30px rgba(0,0,0,0.4); animation: popIn 0.5s; border: 4px double var(--primary-color); }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .intro-card h1 { font-family: 'Ma Shan Zheng', cursive; color: var(--primary-color); font-size: 36px; margin-bottom: 10px; }
        .start-btn { background: var(--primary-color); color: white; border: none; padding: 12px 40px; font-size: 20px; border-radius: 30px; cursor: pointer; margin-top: 20px; font-family: 'ZCOOL XiaoWei', serif; transition: 0.2s; box-shadow: 0 4px 15px rgba(184, 59, 94, 0.4); }
        .start-btn:hover { transform: scale(1.05); background: #9c2e4e; }

        #game-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:3000; justify-content:center; align-items:center; backdrop-filter:blur(5px); }
        
        /* ğŸ”¥ æ–°å¢ï¼šé€šå…³å¥–åŠ±è¯ä¹¦ ğŸ”¥ */
        #victory-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:6000; justify-content:center; align-items:center; backdrop-filter:blur(8px); }
        .certificate { 
            background: #fffbf0; width: 600px; padding: 40px; text-align: center; border-radius: 20px; 
            border: 8px double #d4af37; /* é‡‘è‰²è¾¹æ¡† */
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.6);
            animation: popIn 0.8s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            position: relative; overflow: hidden;
        }
        .certificate::before { content: 'â™›'; position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 80px; color: rgba(212,175,55,0.2); }
        .cert-title { font-family: 'Ma Shan Zheng', cursive; font-size: 48px; color: #d4af37; margin: 0; text-shadow: 2px 2px 0px rgba(0,0,0,0.1); }
        .cert-body { font-size: 20px; color: #555; margin: 30px 0; line-height: 1.6; }
        .cert-seal { width: 100px; height: 100px; border: 4px solid #c0392b; color: #c0392b; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Ma Shan Zheng', cursive; font-size: 24px; position: absolute; bottom: 30px; right: 40px; transform: rotate(-15deg); opacity: 0.8; background: rgba(255,255,255,0.5); }

        #story-ui { position: absolute; top: 80px; left: 20px; z-index: 500; display: none; }
        .task-card { background: rgba(255, 255, 255, 0.95); padding: 15px; border-radius: 10px; border: 2px solid var(--primary-color); margin-bottom: 10px; width: 250px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); backdrop-filter: blur(5px); }
        #calc-panel { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); z-index:3500; }

        #toast { position: fixed; top: 100px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 10px 25px; border-radius: 30px; font-size: 14px; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 1000; font-family: 'ZCOOL XiaoWei', serif; }
        #toast.show { opacity: 1; top: 110px; }
        #loading-mask { position: absolute; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.9); display:flex; justify-content:center; align-items:center; z-index:10; color: var(--primary-color); font-weight:bold; font-family: 'ZCOOL XiaoWei', serif; }
    </style>
</head>
<body>

    <div id="intro-overlay">
        <div class="intro-card">
            <h1>ğŸ“ æ™ºæ…§å‡ ä½•è¯¾å ‚</h1>
            <p style="color:#666; margin: 20px 0; font-size: 18px;">åŒå­¦ä½ å¥½ï¼æˆ‘æ˜¯<b>è‰¾è€å¸ˆ</b>ã€‚<br>å‡†å¤‡å¥½å»çˆ±æ™šäº­æ¢é™©äº†å—ï¼Ÿ</p>
            <div style="display:flex; justify-content:center; gap:30px; margin: 25px 0;">
                <div style="font-size:14px; color:#888; font-family:'ZCOOL XiaoWei',serif;">
                    <i class="fas fa-keyboard" style="font-size:28px; color:var(--primary-color); display:block; margin-bottom:8px;"></i>
                    WASD ç§»åŠ¨
                </div>
                <div style="font-size:14px; color:#888; font-family:'ZCOOL XiaoWei',serif;">
                    <i class="fas fa-mouse" style="font-size:28px; color:var(--primary-color); display:block; margin-bottom:8px;"></i>
                    é¼ æ ‡ æ—‹è½¬
                </div>
            </div>
            <button class="start-btn" onclick="if(window.closeIntro) window.closeIntro(); else alert('èµ„æºåŠ è½½ä¸­ï¼Œè¯·ç¨åå†è¯•ï¼')">ğŸš€ å¼€å§‹ä¸Šè¯¾</button>
        </div>
    </div>

    <div id="victory-modal">
        <div class="certificate">
            <h1 class="cert-title">âœ¨ å‡ ä½•å¤§å¸ˆ âœ¨</h1>
            <div class="cert-body">
                <p>æ­å–œä½ ï¼æˆåŠŸå®Œæˆäº†æ‰€æœ‰æŒ‘æˆ˜ã€‚</p>
                <p>ä½ å·²ç»æŒæ¡äº†åœ†æŸ±ä½“çš„<b>è¡¨é¢ç§¯</b>ä¸<b>ä½“ç§¯</b>å¥¥ç§˜ã€‚</p>
                <p>çˆ±æ™šäº­å› ä½ çš„æ™ºæ…§è€Œæ›´åŠ ç¨³å›ºï¼</p>
            </div>
            <div class="cert-seal">ä¼˜ç§€<br>å­¦å‘˜</div>
            
            <button class="start-btn" onclick="enterFreeExploration()">ğŸ“ é¢†å–è¯ä¹¦ & å¼€å¯è‡ªç”±æ¼«æ­¥</button>
        </div>
    </div>

    <div id="story-ui">
        <div class="task-card">
            <h4 style="margin:0 0 8px 0; color:var(--primary-color); font-family:'Ma Shan Zheng',cursive; font-size:20px;">
                <i class="fas fa-scroll"></i> å½“å‰ä»»åŠ¡
            </h4>
            <p id="current-task" style="margin:0; font-size:15px; font-weight:bold; color:#333; line-height:1.4;">
                å‡†å¤‡ä¸­...
            </p>
        </div>
    </div>

    <div id="calc-panel">
        <div style="background:#fffbf0; padding:30px; border-radius:15px; border:4px solid var(--primary-color); box-shadow:0 10px 40px rgba(0,0,0,0.6); width:400px; text-align:center;">
            <h3 id="calc-title" style="color:var(--primary-color); font-family:'Ma Shan Zheng',cursive; margin-top:0;">ğŸ“ ç«‹æŸ±ä¿®ç¼®å›¾çº¸</h3>
            <div id="calc-content" style="background:#fff; border:2px dashed #999; padding:15px; margin:15px 0; font-family:'Courier New', monospace; text-align:left; color:#555;">
                <p>æ­£åœ¨è·å–æ•°æ®...</p>
            </div>
            <p style="font-size:14px; color:#666;">è¯·è¾“å…¥è®¡ç®—ç»“æœï¼š</p>
            <input type="number" id="calc-input" style="font-size:20px; padding:8px; width:150px; text-align:center; border:2px solid #ddd; border-radius:8px; outline:none;">
            <button onclick="if(window.submitCalculation) window.submitCalculation()" style="background:var(--primary-color); color:white; border:none; padding:10px 30px; font-size:18px; border-radius:20px; cursor:pointer; margin-left:10px; font-family:'ZCOOL XiaoWei', serif;">æäº¤</button>
            <p id="calc-feedback" style="height:20px; color:red; font-size:14px; margin-top:10px;"></p>
        </div>
    </div>

    <div id="game-modal">
        <div class="game-card">
            <div class="close-game" onclick="if(window.closeGame) window.closeGame()">Ã—</div>
            <h2 style="color:var(--primary-color); font-family:'Ma Shan Zheng',cursive;">ğŸ§© å‡ ä½•è´¤è€…æŒ‘æˆ˜</h2>
            <p style="font-size:18px; margin:20px 0;">è¯·é—®ï¼šæ”¯æ’‘çˆ±æ™šäº­å±‹é¡¶çš„â€œå†…æŸ±â€æ˜¯ä»€ä¹ˆå‡ ä½•ä½“ï¼Ÿ</p>
            <div class="game-options">
                <div class="game-option" onclick="if(window.checkAnswer) window.checkAnswer(this, false)">A. é•¿æ–¹ä½“</div>
                <div class="game-option" onclick="if(window.checkAnswer) window.checkAnswer(this, true)">B. åœ†æŸ±ä½“</div>
                <div class="game-option" onclick="if(window.checkAnswer) window.checkAnswer(this, false)">C. åœ†é”¥ä½“</div>
                <div class="game-option" onclick="if(window.checkAnswer) window.checkAnswer(this, false)">D. çƒä½“</div>
            </div>
            <div class="game-result" id="game-result"></div>
        </div>
    </div>

    <div id="learning-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:4000; justify-content:center; align-items:center; backdrop-filter:blur(5px); animation: fadeIn 0.5s;">
        <div style="width:90%; height:90%; max-width:1000px; background:#fff; border-radius:15px; position:relative; overflow:hidden; box-shadow: 0 0 30px rgba(255,255,255,0.2); border: 4px solid var(--primary-color);">
            <button onclick="if(window.closeLearning) window.closeLearning()" style="position:absolute; top:10px; right:15px; background:var(--primary-color); color:#fff; border:none; width:40px; height:40px; border-radius:50%; font-size:20px; cursor:pointer; z-index:100; box-shadow:0 2px 10px rgba(0,0,0,0.2);">Ã—</button>
            
            <iframe id="learning-frame" src="" style="width:100%; height:100%; border:none;"></iframe>
        </div>
    </div>

    <div class="app-wrapper">
        <div class="navbar">
            <div class="container nav-content">
                <div class="logo"><i class="fas fa-shapes"></i> çˆ±æ™šäº­å‡ ä½•</div>
                <div class="nav-tabs">
                    <div class="nav-tab active" onclick="if(window.switchModule) window.switchModule('stroll')">æ¼«æ­¥</div>
                    <div class="nav-tab" onclick="if(window.switchModule) window.switchModule('architect')">å»ºç­‘å¸ˆ</div>
                    <div class="nav-tab" onclick="if(window.switchModule) window.switchModule('workshop')">å·¥åŠ</div>
                </div>
            </div>
        </div>

        <div class="container main-content">
            <div id="stroll" class="module-section active">
                <div class="feature-grid">
                    <div class="control-panel">
                        <h3><i class="fas fa-walking"></i> è‡ªç”±æ¼«æ­¥</h3>
                        <button id="btn-person" class="action-btn active" onclick="if(window.setCameraView) window.setCameraView('person')"><i class="fas fa-street-view"></i> æˆ‘æ˜¯æ¸¸å®¢</button>
                        <button id="btn-top" class="action-btn" onclick="if(window.setCameraView) window.setCameraView('top')"><i class="fas fa-dove"></i> æˆ‘æ˜¯å°é¸Ÿ</button>
                        <button id="btn-front" class="action-btn" onclick="if(window.setCameraView) window.setCameraView('front')"><i class="fas fa-home"></i> æ­£é¢çœ‹</button>
                        <hr style="margin:20px 0; border:0; border-top:1px dashed #ddd;">
                        <button id="btn-leaves" class="action-btn" onclick="if(window.toggleLeaves) window.toggleLeaves()"><i class="fas fa-leaf"></i> è½å¶å¼€å…³</button>
                        <button class="action-btn" onclick="if(window.takeSnapshot) window.takeSnapshot()"><i class="fas fa-camera"></i> æ‹ç…§æ‰“å¡</button>
                    </div>
                    <div class="model-stage" id="canvas-wrapper-stroll">
                        <div id="loading-mask"><i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½èµ„æº...</div>
                        <button class="fullscreen-btn" onclick="if(window.toggleFullscreen) window.toggleFullscreen()" title="å…¨å±"><i class="fas fa-expand"></i></button>
                    </div>
                </div>
            </div>

            <div id="architect" class="module-section"><div class="feature-grid"><div class="control-panel"><h3><i class="fas fa-hard-hat"></i> å»ºç­‘è§£æ„</h3><p style="font-size:14px; color:#666; margin-bottom:15px; text-align:center;">è¯•ç€æ‹†å¼€çœ‹çœ‹é‡Œé¢çš„ç»“æ„ï¼</p><label style="font-size:16px; color:#b83b5e; font-weight:bold;">ğŸ’¥ çˆ†ç‚¸æ‹†è§£</label><input type="range" id="explode-slider" min="0" max="1" step="0.01" value="0" oninput="if(window.updateExplosion) window.updateExplosion(this.value)"><div style="height:15px;"></div><label style="font-size:16px; color:#b83b5e; font-weight:bold;">ğŸ‘“ Xå…‰é€è§†</label><input type="range" min="-2" max="12" step="0.1" value="12" oninput="if(window.updateClipping) window.updateClipping(this.value)"></div><div class="model-stage" id="canvas-wrapper-architect"><button class="fullscreen-btn" onclick="if(window.toggleFullscreen) window.toggleFullscreen()" title="å…¨å±"><i class="fas fa-expand"></i></button></div></div></div>
            <div id="workshop" class="module-section"><div class="feature-grid"><div class="control-panel"><h3><i class="fas fa-calculator"></i> å‡ ä½•ä»»åŠ¡</h3><div style="background:#fff3cd; padding:15px; border-radius:8px; font-size:15px; color:#856404; margin-bottom:15px; border:1px solid #e0dac0;"><strong>ğŸ“œ å½“å‰ä»»åŠ¡ï¼š</strong><br>æ‰¾å‡ºæ”¯æ’‘äº­å­çš„â€œçº¢è‰²åœ†æŸ±ä½“â€ã€‚</div><button class="action-btn active" onclick="if(window.showHint) window.showHint()">ğŸ‘€ ç»™æˆ‘çº¿ç´¢</button><div id="geometry-info" class="hidden" style="margin-top:15px; background:#d1e7dd; padding:15px; border-radius:8px; font-size:15px; color:#0f5132; border:1px solid #badbcc;">âœ… <b>è¯†åˆ«æˆåŠŸ!</b><br>åç§°ï¼šå†…æŸ± (åœ†æŸ±ä½“)<br>ç‰¹å¾ï¼šä¸Šä¸‹ä¸€æ ·ç²—</div></div><div class="model-stage" id="canvas-wrapper-workshop"><button class="fullscreen-btn" onclick="if(window.toggleFullscreen) window.toggleFullscreen()" title="å…¨å±"><i class="fas fa-expand"></i></button></div></div></div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" data-target="stroll" onclick="if(window.switchModule) window.switchModule('stroll')"><i class="fas fa-walking"></i>æ¼«æ­¥</div>
        <div class="nav-item" data-target="architect" onclick="if(window.switchModule) window.switchModule('architect')"><i class="fas fa-layer-group"></i>ç»“æ„</div>
        <div class="nav-item" data-target="workshop" onclick="if(window.switchModule) window.switchModule('workshop')"><i class="fas fa-ruler-combined"></i>å·¥åŠ</div>
        <div id="btn-music" class="nav-item" onclick="if(window.toggleAudio) window.toggleAudio()"><i class="fas fa-music"></i>éŸ³ä¹</div>
    </div>

    <div id="toast"></div>
    <audio id="bgm" loop><source src="bgm.mp3" type="audio/mpeg"></audio>
    <div id="digital-human-container">
        <div id="chat-window" class="chat-window hidden">
            <div class="chat-history" id="chat-history"><div class="message teacher">åŒå­¦ä»¬å¥½ï¼æˆ‘æ˜¯è‰¾è€å¸ˆã€‚ç‚¹å‡»ã€å¼€å§‹ä¸Šè¯¾ã€‘åï¼Œæˆ‘ä¼šå¸¦å¤§å®¶å‚è§‚å“¦ï¼</div></div>
            <div class="chat-input"><input type="text" id="user-input" placeholder="é—®è€å¸ˆ..." onkeypress="if(window.handleKeyPress) window.handleKeyPress(event)"><button onclick="if(window.sendUserMessage) window.sendUserMessage()"><i class="fas fa-paper-plane"></i></button></div>
        </div>
        <div class="video-wrapper" onclick="window.toggleChat()">
            <video id="digital-human-video" src="idle.mp4" loop muted playsinline></video>
        </div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
    <script type="module" src="app.js"></script>
</body>
</html>
