<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>智绘几何 | AI 互动课堂</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <div class="logo">☀️ 智绘几何 <span style="font-size:14px; color:#555; margin-left:10px;">AI 数学课堂</span></div>
        <div class="header-tools">
            <button class="icon-btn" onclick="window.takeSnapshot()" title="保存学习记录">📸 拍照打卡</button>
            <div class="score-board" id="scoreBoard">🏆 积分: 0</div>
        </div>
    </header>

    <div id="stage-nav">
        <button class="stage-btn active" onclick="window.switchStage(1)" title="漫步模式">🏃</button>
        <button class="stage-btn" onclick="window.switchStage(2)" title="解构模式">🔨</button>
        <button class="stage-btn" onclick="window.switchStage(3)" title="几何工坊">📐</button>
    </div>

    <div id="control-panel">
        <div id="panel-1" class="panel-section active">
            <h3>🏫 场景一：漫步爱晚亭</h3>
            <p>👋 <b>操作指南：</b><br><b>[W][A][S][D]</b> 移动<br><b>按住鼠标左键</b> 旋转视角</p>
            <button class="tool-btn active" onclick="window.toggleLeaves()">🍃 自然落叶 (开/关)</button>
        </div>

        <div id="panel-2" class="panel-section">
            <h3>📐 场景二：我是建筑师</h3>
            <p>拖动滑块，观察古建筑的榫卯结构。</p>
            <label>🏗️ 拆解屋顶</label>
            <input type="range" min="0" max="3" step="0.1" value="0" oninput="window.updatePillarExplode(this.value)">
            <label>🔍 X光透视</label>
            <input type="range" min="-1" max="7" step="0.1" value="7" oninput="window.updateClipping(this.value)">
        </div>

        <div id="panel-3" class="panel-section">
            <h3>🎮 场景三：几何工坊</h3>
            <button class="tool-btn active" onclick="window.setInteractMode('game')">🔍 开始寻找圆柱体</button>
            <p style="font-size:12px; color:#666; margin-top:10px;">点击场景中红色的柱子来完成任务。</p>
        </div>
    </div>

    <div class="avatar-container" onclick="document.getElementById('chat-window').classList.remove('hidden'); window.askTeacher('welcome');">
        <div class="avatar-img-wrapper">
            <video id="digital-human-video" src="idle.mp4" class="avatar-img" autoplay loop muted playsinline></video>
        </div>
    </div>

    <div class="chat-window" id="chat-window">
        <div class="chat-header">
            <span>🎓 艾老师在线</span>
            <button class="close-btn" onclick="window.toggleChat()">×</button>
        </div>
        <div class="chat-messages" id="chat-history">
            <div class="message teacher">同学们好！我是艾老师。<br>你可以直接在下面输入问题问我哦！👇</div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="user-input" placeholder="输入你的问题..." onkeypress="window.handleKeyPress(event)">
            <button onclick="window.sendUserMessage()">发送</button>
        </div>
    </div>

    <div id="loading">🚀 正在加载 AI 课堂资源...</div>
    <div id="canvas-container"></div>
    <div id="toast" class="toast">消息提示</div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
    </script>
    <script type="module" src="app.js"></script>
</body>
</html>

